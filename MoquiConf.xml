<?xml version="1.0" encoding="UTF-8"?>
<!-- No copyright or license for configuration file, details here are not considered a creative work. -->
<moqui-conf xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/moqui-conf-3.xsd">

    <!-- JWT Authentication Filter Configuration -->
    <webapp-list>
        <webapp name="webroot">
            <filter name="JwtAuthenticationFilter" class="org.moqui.impl.webapp.JwtAuthenticationFilter"/>
            <filter-mapping name="JwtAuthenticationFilter" url-pattern="/marketplace/*"/>
            <filter-mapping name="JwtAuthenticationFilter" url-pattern="/mcp/*"/>
            <filter-mapping name="JwtAuthenticationFilter" url-pattern="/qapps/*"/>
            <!-- REST API resource registration -->
            <rest-api>
                <resource location="component://moqui-mcp/service/mcp.rest.xml"/>
            </rest-api>
        </webapp>
    </webapp-list>

    <screen-facade>
        <screen location="component://webroot/screen/webroot.xml">
            <subscreens-item name="mcp" location="component://moqui-mcp/screen/McpSite/McpSite.xml"/>
            <subscreens-item name="mcp-includes" location="component://moqui-mcp/screen/includes.xml"/>
        </screen>
        <screen location="component://webroot/screen/webroot/apps.xml">
            <subscreens-item name="mcp" menu-title="AI Marketing Assistant" menu-index="98" location="component://moqui-mcp/screen/McpDialogScreen.xml"/>
        </screen>
    </screen-facade>

    <!-- Telegram 集成默认配置 -->
    <!-- Telegram Bot 用户名（用于调试说明） -->
    <default-property name="mcp.telegram.bot.username" value="UpServceBot"/>
    <!-- Telegram Bot Token（请通过环境变量 TELEGRAM_BOT_TOKEN 或系统属性 mcp.telegram.bot.token 覆盖） -->
    <default-property name="mcp.telegram.bot.token" value="6889801043:AAF5wdoc4tybZEqCXtO5229tOErnK_ZUzMA"/>
    <!-- Telegram API Base URL -->
    <default-property name="mcp.telegram.api.base" value="https://api.telegram.org"/>
    <!-- 可选：Webhook 校验密钥 -->
    <default-property name="mcp.telegram.webhook.secret" value=""/>
</moqui-conf>